Sub ChangeCheckboxState()
    Dim cb As Object
    Set cb = ActiveDocument.Shapes("CheckBox1").OLEFormat.Object ' Name of your checkbox
    
    ' Change the state and color of the checkbox
    If cb.Value = 0 Then
        cb.Value = 1 ' Set checked state
        cb.ForeColor.RGB = RGB(0, 255, 0) ' Green color (checkmark)
    ElseIf cb.Value = 1 Then
        cb.Value = 2 ' Set indeterminate state
        cb.ForeColor.RGB = RGB(255, 255, 0) ' Yellow (Hourglass)
    ElseIf cb.Value = 2 Then
        cb.Value = 0 ' Set unchecked state
        cb.ForeColor.RGB = RGB(255, 0, 0) ' Red color (Cross)
    End If
End Sub
