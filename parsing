Sub CreateBlocksWithVariable()
    Dim sourceCell As Range
    Dim values As Variant
    Dim i As Long
    Dim lastRow As Long
    Dim blockStartRow As Long
    Dim blockCount As Long ' Variable to store the number of blocks
    
    ' Set the cell with the source values
    Set sourceCell = Range("A1") ' Change this to the cell you need

    ' Split the values in the cell into an array by comma
    values = Split(sourceCell.Value, ",")
    
    ' Determine the number of blocks
    blockCount = UBound(values) - LBound(values) + 1

    ' Determine the last row to insert blocks
    lastRow = Cells(Rows.Count, "B").End(xlUp).Row
    blockStartRow = lastRow + 1
    
    ' Loop through each value and create blocks
    For i = LBound(values) To UBound(values)
        ' Write the value into column B
        Cells(blockStartRow + i, 2).Value = Trim(values(i))
    Next i
    
    ' Display the variable with the number of blocks
    MsgBox "Number of blocks: " & blockCount
End Sub
